(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{4927:function(e,t,r){Promise.resolve().then(r.t.bind(r,1034,23)),Promise.resolve().then(r.t.bind(r,3054,23)),Promise.resolve().then(r.bind(r,409)),Promise.resolve().then(r.bind(r,1765))},409:function(e,t,r){"use strict";r.d(t,{AppProvider:function(){return c},b:function(){return u}});var n=r(7437),i=r(2265),o=r(5159);let a=(0,i.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,i.useState)([]),[u,s]=(0,i.useState)([]),[d,l]=(0,i.useState)([]),m=(e,t)=>{l([...e.map(e=>({id:"milestone-".concat(e.id),nom:"".concat(e.numeroEtape," - ").concat(e.description),type:"milestone",referenceId:e.id,documents:[]})),...t.map(e=>({id:"dcr-".concat(e.id),nom:"".concat(e.numeroEtape," - ").concat(e.description),type:"dcr",referenceId:e.id,documents:[]}))])};return(0,i.useEffect)(()=>{(r.length>0||u.length>0)&&m(r,u)},[r,u]),(0,n.jsx)(a.Provider,{value:{milestones:r,dcrs:u,folders:d,setMilestones:c,setDcrs:s,setFolders:l,addMilestone:e=>{c(t=>[...t,e])},addDCR:e=>{s(t=>[...t,e])},updateMilestone:(e,t)=>{c(r=>r.map(r=>r.id===e?{...r,...t}:r))},updateDCR:(e,t)=>{s(r=>r.map(r=>r.id===e?{...r,...t}:r))},addDocumentToFolder:(e,t)=>{l(r=>r.map(r=>r.id===e?{...r,documents:[...r.documents,t]}:r))},removeDocumentFromFolder:(e,t)=>{l(r=>r.map(r=>r.id===e?{...r,documents:r.documents.filter(e=>e.id!==t)}:r))},getDocumentsForItem:(e,t)=>{let r="".concat(e,"-").concat(t),n=d.find(e=>e.id===r);return n?n.documents:[]}},children:(0,n.jsx)(o.C,{children:t})})}function u(){let e=(0,i.useContext)(a);if(void 0===e)throw Error("useAppContext must be used within an AppProvider");return e}},5159:function(e,t,r){"use strict";r.d(t,{C:function(){return c},s:function(){return u}});var n=r(7437),i=r(2265);let o=(0,i.createContext)(void 0),a=[{id:"formulaire-1111",nom:"Formulaire 1111",type:"formulaire",statut:"vide",ordre:1},{id:"payment-claim",nom:"Payment Claim",type:"formulaire",statut:"vide",ordre:2},{id:"facture-sap",nom:"Facture SAP",type:"import",statut:"vide",ordre:3},{id:"courriel-client",nom:"Courriel de confirmation du client",type:"import",statut:"vide",ordre:4},{id:"documents-annexes",nom:"Documents annexes",type:"import",statut:"vide",ordre:5}];function c(e){let{children:t}=e,[r,c]=(0,i.useState)(a);return(0,n.jsx)(o.Provider,{value:{documents:r,updateDocument:(e,t)=>{c(r=>r.map(r=>r.id===e?{...r,...t}:r))},getNextAvailableDocument:()=>r.find(e=>"vide"===e.statut)||null,isDocumentAccessible:e=>1===e||r.filter(t=>t.ordre<e).every(e=>"complete"===e.statut),isAllDocumentsComplete:()=>r.every(e=>"complete"===e.statut),getDocumentById:e=>r.find(t=>t.id===e),resetAllDocuments:()=>{c(a.map(e=>({...e,statut:"vide",fichier:null,contenu:void 0,previewData:void 0})))}},children:t})}function u(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useDocuments must be used within a DocumentsProvider");return e}},1765:function(e,t,r){"use strict";r.d(t,{PriceSyncProvider:function(){return c},S:function(){return u}});var n=r(7437),i=r(2265);let o=(0,i.createContext)(void 0),a=[{id:"c228",name:"C-228 NLT1",milestones:[],dcrs:[],registers:[],formAmounts:[],taxRate:.15},{id:"c229",name:"C-229 NLT2",milestones:[],dcrs:[],registers:[],formAmounts:[],taxRate:.15},{id:"c230",name:"C-230 NLT3",milestones:[],dcrs:[],registers:[],formAmounts:[],taxRate:.15},{id:"c231",name:"C-231 NLT4",milestones:[],dcrs:[],registers:[],formAmounts:[],taxRate:.15}];function c(e){let{children:t}=e,[r,c]=(0,i.useState)(a),u=(e,t)=>e*(1+t),s=(e,t,r,n,i)=>{console.log("Synchronizing to registers: ".concat(e,", ").concat(t,", ").concat(r,", ").concat(n))},d=(e,t,r)=>{console.log("Removing from registers: ".concat(e,", ").concat(t,", ").concat(r))},l=(e,t,r)=>{console.log("Synchronizing to forms: ".concat(e,", ").concat(t))};return(0,n.jsx)(o.Provider,{value:{projects:r,updateMilestonePrice:(e,t,r)=>{c(n=>n.map(n=>{if(n.id!==e)return n;let i=n.milestones.map(e=>{if(e.id===t){let t={...e,prixUnitaireFerme:r,prixFermeTotal:r};return e.facture&&(s(n.id,"milestone",e.id,r,n.taxRate),l(n.id,r,n.taxRate)),t}return e});return{...n,milestones:i}}))},updateDCRPrice:(e,t,r)=>{c(n=>n.map(n=>{if(n.id!==e)return n;let i=n.dcrs.map(e=>{if(e.id===t){let t={...e,prixUnitaireFerme:r,prixFermeTotal:r};return e.facture&&(s(n.id,"dcr",e.id,r,n.taxRate),l(n.id,r,n.taxRate)),t}return e});return{...n,dcrs:i}}))},toggleMilestoneFacture:(e,t)=>{c(r=>r.map(r=>{if(r.id!==e)return r;let n=r.milestones.map(e=>{if(e.id===t){let t=!e.facture,n={...e,facture:t};return t?s(r.id,"milestone",e.id,e.prixUnitaireFerme,r.taxRate):d(r.id,"milestone",e.id),l(r.id,e.prixUnitaireFerme,r.taxRate),n}return e});return{...r,milestones:n}}))},toggleDCRFacture:(e,t)=>{c(r=>r.map(r=>{if(r.id!==e)return r;let n=r.dcrs.map(e=>{if(e.id===t){let t=!e.facture,n={...e,facture:t};return t?s(r.id,"dcr",e.id,e.prixUnitaireFerme,r.taxRate):d(r.id,"dcr",e.id),l(r.id,e.prixUnitaireFerme,r.taxRate),n}return e});return{...r,dcrs:n}}))},calculateTTC:u,getTotalsByProject:e=>{let t=r.find(t=>t.id===e);if(!t)return{totalMilestonesHT:0,totalMilestonesTTC:0,totalDCRsHT:0,totalDCRsTTC:0,totalFactureHT:0,totalFactureTTC:0,totalContractHT:0,totalContractTTC:0};let n=t.milestones.reduce((e,t)=>e+t.prixFermeTotal,0),i=t.dcrs.reduce((e,t)=>e+t.prixFermeTotal,0),o=t.milestones.filter(e=>e.facture).reduce((e,t)=>e+t.prixFermeTotal,0)+t.dcrs.filter(e=>e.facture).reduce((e,t)=>e+t.prixFermeTotal,0),a=n+i;return{totalMilestonesHT:n,totalMilestonesTTC:u(n,t.taxRate),totalDCRsHT:i,totalDCRsTTC:u(i,t.taxRate),totalFactureHT:o,totalFactureTTC:u(o,t.taxRate),totalContractHT:a,totalContractTTC:u(a,t.taxRate)}},getFormAmountsByProject:e=>{let t=r.find(t=>t.id===e);return(null==t?void 0:t.formAmounts)||[]}},children:t})}function u(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("usePriceSync must be used within a PriceSyncProvider");return e}},3054:function(){},1034:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[6,971,23,744],function(){return e(e.s=4927)}),_N_E=e.O()}]);